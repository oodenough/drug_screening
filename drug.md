# 课程设计文档：基于大数据分析的药物筛选系统

## 1. 项目概述

### 1.1 项目背景

新药研发是一个耗时、耗资巨大的过程。通过大数据分析与深度学习技术进行虚拟筛选（Virtual Screening），可以在实验室合成之前预测候选化合物的活性和毒性，从而显著降低研发成本。

### 1.2 设计目标

本系统旨在构建一个集成数据预处理、分子特征提取、活性预测及可视化分析于一体的药物筛选平台。

- **核心技术**：Python, PyTorch/TensorFlow, RDKit（化学信息学库）, Pandas。
- **算法选择**：基于分子指纹的 MLP（多层感知机）或基于 SMILES 序列的 1D-CNN。

------

## 2. 系统架构设计

系统采用模块化设计，分为数据层、特征层、算法层和展示层。

| **分层**   | **功能描述**                                                 |
| ---------- | ------------------------------------------------------------ |
| **数据层** | 收集并存储开源药物数据库（如 , MoleculeNet, ）的数据。 |
| **特征层** | 将化学分子（SMILES 字符串）转化为计算机可识别的向量（分子指纹或编码）。 |
| **算法层** | 构建深度学习模型，进行属性预测（如溶解度、毒性、结合亲和力）。 |
| **展示层** | 提供交互式界面，支持分子结构显示、预测结果排名及热力图分析。 |

------

## 3. 功能模块详细实现

### 3.1 数据预处理模块

- **数据源**：使用 MoleculeNet 中的 **BACE**（预测酶抑制剂活性）使用DeepChem内置的MoleculeNet加载器（自动下载BBBP、Tox21、ESOL等数据集）。
- **清洗**：去除重复的 SMILES 序列，处理缺失值。
- **数据格式**：将 SMILES（如 `CC(=O)OC1=CC=CC=C1C(=O)O`）标准化。

### 3.2 特征提取模块（分子指纹化）

为了让深度学习模型理解分子，我们需要进行数值化处理：

- **摩根指纹 (Morgan Fingerprints)**：利用 RDKit 将分子转化为 1024 或 2048 位的位向量（0/1 序列）。
- **SMILES 编码**：将字符转化为 One-hot 编码，输入到 CNN 中。

### 3.3 深度学习预测模块（核心算法）

PyTorch用于模型开发，可选集成DeepChem的预训练模型，这里推荐使用**多层感知机 (MLP)**，因为它结构简单且在小分子筛选上效果稳定。

**已实现架构**:
- **输入层**: 1024维 ECFP分子指纹
- **隐藏层1**: 512神经元 + BatchNorm + ReLU + Dropout(0.5)
- **隐藏层2**: 256神经元 + BatchNorm + ReLU + Dropout(0.5)
- **隐藏层3**: 128神经元 + BatchNorm + ReLU + Dropout(0.5)
- **输出层**:
  - 分类任务 (BBBP): Sigmoid（预测能否穿透血脑屏障）
  - 回归任务 (ESOL): Linear（预测水溶解度）

**模型性能**:
- 总参数量: 690,945
- GPU加速: NVIDIA RTX 3050 Ti
- BBBP AUC-ROC: 70.12%
- ESOL R²: 0.5120

Python

```
# 简单的模型示例 (PyTorch 风格)
import torch.nn as nn

class DrugPredictor(nn.Module):
    def __init__(self, input_dim):
        super(DrugPredictor, self).__init__()
        self.net = nn.Sequential(
            nn.Linear(input_dim, 512),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(512, 128),
            nn.ReLU(),
            nn.Linear(128, 1)  # 输出一个预测分值
        )
    
    def forward(self, x):
        return self.net(x)
```

### 3.4 虚拟筛选与排序模块
功能模块列表

数据管理模块

特征工程模块

模型训练模块

药物预测模块

筛选排序模块

可视化分析模块
- **批量筛选**：导入包含数万个小分子的 `.csv` 或 `.sdf` 文件。
- **预测评分**：模型对所有分子进行打分。
- **Top-K 过滤**：自动提取评分前 100 的“高潜力”化合物，生成候选清单。

### 3.5 数据可视化模块

- 使用Streamlit在web/创建交互式界面，允许用户输入SMILES并可视化各模块的预测结果，展示分子结构和性质评分**分子结构展示**：使用 RDKit 在界面上绘制候选分子的 2D 结构。
- **属性分布图**：使用 Matplotlib 绘制预测分数的分布直方图。
- **降维分析**：利用 T-SNE 算法将高维分子指纹映射到 2D 平面，观察活性分子与非活性分子的聚类情况。

------

## 4. 技术栈推荐

- **编程语言**：Python 3.9+
- **深度学习框架**：PyTorch 或 Keras
- **化学信息学工具**：RDKit (核心：`conda install -c rdkit rdkit`)
- **前端展示**：Streamlit（非常适合快速搭建 AI 演示 Demo，仅需几行 Python 代码）
- **数据处理**：Pandas, Numpy, Scikit-learn